<!DOCTYPE html>
<html>
<head>
  <title>QR Code Scanner and Google Sheet Poster</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
  <h2>Scan QR from Local Image</h2>
  <input type="file" accept="image/*" id="file-input" />
  <p id="result">Waiting for scan...</p>

  <!-- Hidden div required by Html5Qrcode -->
  <div id="reader" style="display: none;"></div>

  <script>
    const input = document.getElementById("file-input");
    const result = document.getElementById("result");

    input.addEventListener("change", async () => {
      const file = input.files[0];
      if (!file) return;

      const qrCodeScanner = new Html5Qrcode("reader");
      try {
        const decoded = await qrCodeScanner.scanFile(file, true);
        result.innerText = "‚úÖ Scanned: " + decoded;

        // ‚úÖ Now send to Google Sheets
        const url = "https://script.google.com/macros/s/AKfycbyCKPkYP9U9lZf9N6kUff-jQRWSySz_w7164Tm3UR6FUApUFFpXJsk9-K9hZUyAenJcfA/exec";

        fetch(url, {
          method: "POST",
          mode: "no-cors",  // Prevents CORS error, though you won't get success confirmation
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            data: decoded
          })
        });

        result.innerText += "\nüì§ Posted to Google Sheets.";

      } catch (err) {
        result.innerText = "‚ùå Error scanning: " + err;
      }
    });
  </script>
</body>
</html>
